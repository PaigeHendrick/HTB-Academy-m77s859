# Penetration Testing Report: Exploitation

## 1. **Overview of Exploitation**
The exploitation phase involves leveraging identified vulnerabilities to gain unauthorized access or escalate privileges within the target environment. This phase is critical for demonstrating the real-world impact of vulnerabilities.

### **Objectives:**
- Validate the existence of identified vulnerabilities.
- Gain access to systems or data.
- Assess the potential for further exploitation and lateral movement.

## 2. **Exploitation Methodology**
The exploitation process was carried out using a combination of automated tools and manual techniques. The following steps were taken:

1. **Preparation:**
   - Review of vulnerability findings from the previous phase.
   - Selection of appropriate exploitation techniques based on identified vulnerabilities.

2. **Execution:**
   - Conducted exploitation attempts using tools and custom scripts.
   - Documented success and failure of each exploitation attempt.

3. **Post-Exploitation:**
   - Evaluated the extent of access gained and potential for lateral movement.
   - Identified sensitive data and other assets accessible post-exploitation.

## 3. **Tools Used for Exploitation**

| **Tool**                | **Description**                                       | **Purpose**                                        |
|-------------------------|-------------------------------------------------------|---------------------------------------------------|
| **Metasploit**          | Framework for developing and executing exploit code   | Automate the exploitation process                  |
| **SQLMap**              | Tool for automating the process of detecting and exploiting SQL injection flaws | SQL injection exploitation                         |
| **Burp Suite**          | Integrated platform for performing security testing of web applications | Manual testing and automated exploitation           |
| **Cobalt Strike**       | Tool for advanced adversary simulations and post-exploitation | Lateral movement and persistence testing           |

## 4. **Findings from Exploitation**

### **Summary of Successful Exploitation:**

| **Target**    | **Vulnerability Exploited**       | **Method Used**    | **Access Gained**                                      | **Impact**                         |
| ------------- | --------------------------------- | ------------------ | ------------------------------------------------------ | ---------------------------------- |
| `10.10.16.52` | **CVE-2019-11231**                | Metasploit Exploit | Remote code execution                                  | Full control over the web server   |
| `10.10.16.52` | **Insufficient Password Hashing** | Dictionary Attack  | Access to GetSimple CMS Admin with weak hashing algos. | Compromise of the web application. |

### **Detailed Exploitation Analysis:**

#### 1. **CVE-2021-34527**
- **Target:** `10.10.16.52`
- **Method Used:** Metasploit framework
- **Access Gained:** Remote command execution
- **Impact:** Gained full control of the web server, allowing further actions such as deploying malware or exfiltrating sensitive data.
#### 2. **Insufficient Password Hashing**
- **Target:** `10.10.16.52`
- **Method Used:** Cracked weakly hashed passwords using a precomputed dictionary (rainbow tables).
- **Access Gained:** Retrieved user credentials from an exposed endpoint in /data/users where passwords were stored using weak hashing algorithms (e.g., MD5, SHA-1).
- **Impact:** Compromised admin account, enabling privilege escalation and unauthorized access to sensitive data.

Example:

![[../20241007-M77S859-Notes/2. Recon/Images/Pasted image 20241007223741.png]]

```console
┌──(paige㉿PH-LT02)-[~]
└─$ curl -s  http://10.10.16.52/data/users/admin.xml.reset | xmllint --format - 
<?xml version="1.0" encoding="UTF-8"?>
<item>
  <USR>admin</USR>
  <NAME/>
  <PWD>d033e22ae348aeb5660fc2140aec35850c4da997</PWD>
  <EMAIL>admin@gettingstarted.com</EMAIL>
  <HTMLEDITOR>1</HTMLEDITOR>
  <TIMEZONE/>
  <LANG>en_US</LANG>
</item>
```

```console
┌──(paige㉿PH-LT02)-[/usr/lib/win-kex/pulse]                                  
└─$ echo -n "admin" | sha1sum
d033e22ae348aeb5660fc2140aec35850c4da997  -
```
#### 3. **Weak Password Policy**
- **Target:** `10.10.16.52`
- **Method Used:** Finding
- **Access Gained:** Compromised GetSimple CMS admin with default or weak passwords
- **Impact:** Gained access to the admin backend, potentially allowing data manipulation or extraction.


## 5. **Conclusion**
The exploitation phase demonstrated that several identified vulnerabilities could be successfully leveraged to gain access to critical systems and data. Immediate remediation actions are recommended to mitigate the risks associated with these vulnerabilities.

### **Next Steps:**
- Move to the Post-Exploitation phase to assess the extent of access and further evaluate the potential for lateral movement and data exfiltration.
