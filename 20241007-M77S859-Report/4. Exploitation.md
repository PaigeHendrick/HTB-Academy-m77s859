# Penetration Testing Report: Exploitation

## 1. **Overview of Exploitation**
The exploitation phase involves leveraging identified vulnerabilities to gain unauthorized access or escalate privileges within the target environment. This phase is critical for demonstrating the real-world impact of vulnerabilities.

### **Objectives:**
- Validate the existence of identified vulnerabilities.
- Gain access to systems or data.
- Assess the potential for further exploitation and lateral movement.

## 2. **Exploitation Methodology**
The exploitation process was carried out using a combination of automated tools and manual techniques. The following steps were taken:

1. **Preparation:**
   - Review of vulnerability findings from the previous phase.
   - Selection of appropriate exploitation techniques based on identified vulnerabilities.

2. **Execution:**
   - Conducted exploitation attempts using tools and custom scripts.
   - Documented success and failure of each exploitation attempt.

3. **Post-Exploitation:**
   - Evaluated the extent of access gained and potential for lateral movement.
   - Identified sensitive data and other assets accessible post-exploitation.

## 3. **Tools Used for Exploitation**

| **Tool**          | **Description**                                                                 | **Purpose**                               |
| ----------------- | ------------------------------------------------------------------------------- | ----------------------------------------- |
| **Metasploit**    | Framework for developing and executing exploit code                             | Automate the exploitation process         |

## 4. **Findings from Exploitation**

### **Summary of Successful Exploitation:**

| **Target**    | **Vulnerability Exploited**           | **Method Used**    | **Access Gained**                                             | **Impact**                         |
| ------------- | ------------------------------------- | ------------------ | ------------------------------------------------------------- | ---------------------------------- |
| `10.10.16.52` | **CVE-2019-11231**                    | Metasploit Exploit | Remote code execution                                         | Full control over the web server   |
| `10.10.16.52` | **CWE-328: Use of Weak Hash**         | Dictionary Attack  | Access to GetSimple CMS Admin with weak hashing algos.        | Compromise of the web application. |
| `10.10.16.52` | **CWE-1391: Use of Weak Credentials** | Guessed            | Access to GetSimple CMS admin with default or weak passwords. | Compromise of the web application. |

### **Detailed Exploitation Analysis:**

#### 1. **CVE-2021-34527**
- **Target:** `10.10.16.52`
- **Method Used:** Metasploit framework
- **Access Gained:** Remote command execution
- **Impact:** Gained full control of the web server, allowing further actions such as deploying malware or exfiltrating sensitive data.

![Screenshot of Exploit \\CVE-2021-34527](<../20241007-M77S859-Notes/2. Recon/Images/Pasted image 20241007144838.png>)
#### 2. **CWE-328: Use of Weak Hash**
- **Target:** `10.10.16.52`
- **Method Used:** Cracked weakly hashed passwords using a precomputed dictionary (rainbow tables).
- **Access Gained:** Retrieved user credentials from an exposed endpoint in /data/users where passwords were stored using weak hashing algorithms (e.g., MD5, SHA-1).
- **Impact:** Compromised admin account, enabling privilege escalation and unauthorized access to sensitive data.
- **Additional Infomation:** https://cwe.mitre.org/data/definitions/328.html 

Example:

![../20241007-M77S859-Notes/2. Recon/Images/Pasted image 20241007223741.png](<../20241007-M77S859-Notes/2. Recon/Images/Pasted image 20241007223741.png>)

```console
┌──(paige㉿PH-LT02)-[~]
└─$ curl -s  http://10.10.16.52/data/users/admin.xml.reset | xmllint --format - 
<?xml version="1.0" encoding="UTF-8"?>
<item>
  <USR>admin</USR>
  <NAME/>
  <PWD>d033e22ae348aeb5660fc2140aec35850c4da997</PWD>
  <EMAIL>admin@gettingstarted.com</EMAIL>
  <HTMLEDITOR>1</HTMLEDITOR>
  <TIMEZONE/>
  <LANG>en_US</LANG>
</item>
```

```console
┌──(paige㉿PH-LT02)-[/usr/lib/win-kex/pulse]                                  
└─$ echo -n "admin" | sha1sum
d033e22ae348aeb5660fc2140aec35850c4da997  -
```
#### 3. **CWE-1391: Use of Weak Credentials**
- **Target:** `10.10.16.52`
- **Method Used:** Guessed weak password 
- **Access Gained:** Compromised GetSimple CMS admin with default or weak passwords.
- **Impact:** Gained access to the admin backend, potentially allowing data manipulation or extraction.
- **Additional Infomation:** https://cwe.mitre.org/data/definitions/1391.html 


